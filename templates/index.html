{% extends "base.html" %}

{% block title %}Calculadora Shopee ‚Äì Calcular Lucro e Pre√ßo Ideal | Venda Certa Web{% endblock %}

{% block content %}

<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

<div class="page-content">

<div class="header">
    <h1 class="logo-text">Calcule seu lucro e pre√ßo ideal na Shopee</h1>
    <p>Ferramenta gratuita para vendedores online.</p>

    <p style="margin-top:10px;color:#666;font-size:14px;">
        ‚úîÔ∏è Gr√°tis &nbsp; ‚Ä¢ &nbsp; ‚úîÔ∏è Sem cadastro &nbsp; ‚Ä¢ &nbsp; ‚úîÔ∏è Resultado imediato
    </p>
</div>

<div class="grid">

<!-- ================= MODO 1 ================= -->
<div class="container">

<h2>üìä Calcular Lucro Shopee</h2>

<form method="POST" onsubmit="converterCampos(this)">
<input type="hidden" name="modo" value="modo1">

<label>Custo do Produto</label>
<input type="text" class="money" name="custo" required>

<label>Pre√ßo de Venda</label>
<input type="text" class="money" name="preco_venda" required>

<div class="checkbox-group">
<input type="checkbox" name="frete_gratis" id="f1">
<label for="f1">Frete gr√°tis</label>
</div>

<button type="submit">Calcular</button>
</form>

{% if resultado1 %}
<div class="resultado">
<div class="status {{ classe_lucro }}">
<div class="bolinha"></div>
<span>{{ status_texto }}</span>
</div>

<p class="lucro-destaque">Lucro: R$ {{ resultado1.lucro }}</p>
<p><strong>Custo do Produto:</strong> R$ {{ resultado1.custo }}</p>
<p><strong>Pre√ßo de Venda:</strong> R$ {{ resultado1.preco_venda }}</p>
<p><strong>Taxa Shopee (14%):</strong> R$ {{ resultado1.taxa_percentual }}</p>

{% if resultado1.taxa_frete_num > 0 %}
<p><strong>Taxa Frete Gr√°tis (6%):</strong> R$ {{ resultado1.taxa_frete }}</p>
{% endif %}

<p><strong>Taxa Fixa Shopee:</strong> R$ {{ resultado1.taxa_fixa }}</p>
<p><strong>Margem de Lucro:</strong> {{ resultado1.margem_real }}%</p>
</div>
{% endif %}

</div>

<!-- ================= MODO 2 ================= -->
<div class="container">

<h2>üí∞ Calcular Pre√ßo Ideal Shopee</h2>

<form method="POST" onsubmit="converterCampos(this)">
<input type="hidden" name="modo" value="modo2">

<label>Custo do Produto</label>
<input type="text" class="money" name="custo2" required>

<label>Margem desejada (%)</label>
<input type="text" name="margem_desejada" class="percentual" required>

<div class="checkbox-group">
<input type="checkbox" name="frete_gratis2" id="f2">
<label for="f2">Frete gr√°tis</label>
</div>

<button type="submit">Calcular</button>
</form>

{% if resultado2 %}
<div class="resultado">
<p class="lucro-destaque">Pre√ßo Ideal: R$ {{ resultado2.preco_ideal }}</p>
<p><strong>Lucro:</strong> R$ {{ resultado2.lucro }}</p>
<p><strong>Custo do Produto:</strong> R$ {{ resultado2.custo }}</p>
<p><strong>Margem de Lucro Real:</strong> {{ resultado2.margem_real }}%</p>
<p><strong>Taxa Shopee (14%):</strong> R$ {{ resultado2.taxa_shopee }}</p>

{% if resultado2.taxa_frete_num > 0 %}
<p><strong>Taxa Frete Gr√°tis (6%):</strong> R$ {{ resultado2.taxa_frete }}</p>
{% endif %}

<p><strong>Taxa Fixa Shopee:</strong> R$ {{ resultado2.taxa_fixa }}</p>
<p><strong>Valor Recebido:</strong> R$ {{ resultado2.valor_recebido }}</p>
</div>
{% endif %}

</div>

</div>
</div>

<p style="text-align:center; font-size:13px; color:#777; margin-top:25px;">
Os valores apresentados s√£o estimativas baseadas nas taxas atuais e podem variar conforme mudan√ßas nas regras da plataforma ou condi√ß√µes espec√≠ficas de cada venda.
</p>

<script>
function formatarMoeda(valor){
    valor = valor.replace(/\D/g,'');
    valor = (valor/100).toFixed(2)+'';
    valor = valor.replace(".",",");
    valor = valor.replace(/\B(?=(\d{3})+(?!\d))/g,".");
    return valor;
}

document.querySelectorAll(".money").forEach(input=>{
    input.addEventListener("input",function(){
        this.value=formatarMoeda(this.value);
    });
});

function converterCampos(form){
    form.querySelectorAll(".money").forEach(input=>{
        input.value=input.value.replace(/\./g,'').replace(',','.');
    });
}

document.querySelectorAll(".percentual").forEach(input=>{
    input.addEventListener("input", function(){
        this.value = this.value.replace(/[^0-9.,]/g,'');
    });
});
</script>

{% endblock %}